# -*- coding: utf-8 -*-
"""
/***************************************************************************
 QSEQUOIA2DockWidget
                                 A QGIS plugin
 simplifions le qutodien des forestiers
 Generated by Plugin Builder: http://g-sherman.github.io/Qgis-Plugin-Builder/
                             -------------------
        begin                : 2026-01-07
        git sha              : $Format:%H$
        copyright            : (C) 2026 by Alexandre Le Bars - SequoiAPP
        email                : alexlb329@gmail.com
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
"""

import os

from qgis.PyQt import QtGui, QtWidgets, uic
from qgis.PyQt.QtCore import pyqtSignal
from qgis.PyQt.QtWidgets import QFileDialog
from qgis.PyQt.QtWidgets import QTreeWidgetItem
from PyQt5.QtGui import QIcon

FORM_CLASS, _ = uic.loadUiType(os.path.join(
    os.path.dirname(__file__), 'QSEQUOIA2_dockwidget_base.ui'))


class QSEQUOIA2DockWidget(QtWidgets.QDockWidget, FORM_CLASS):

    closingPlugin = pyqtSignal()

    def __init__(self, parent=None):
        """Constructor."""
        super(QSEQUOIA2DockWidget, self).__init__(parent)
        # Set up the user interface from Designer.
        # After setupUI you can access any designer object by doing
        # self.<objectname>, and you can use autoconnect slots - see
        # http://doc.qt.io/qt-5/designer-using-a-ui-file.html
        # #widgets-and-dialogs-with-auto-connect
        self.setupUi(self)
        self.populate_functions_tree()

        # chemin vers ton logo
        plugin_dir = os.path.dirname(__file__)
        logo_path = os.path.join(plugin_dir, "icon.png")

        # d√©finit l‚Äôic√¥ne du dockwidget
        self.setWindowIcon(QIcon(logo_path))




    def populate_functions_tree(self):
        tree = self.functionsLibrary
        tree.clear()

        # =========================
        # Traitements bureautique
        # =========================
        bureautique = QTreeWidgetItem(tree)
        bureautique.setText(0, "Traitements bureautique")

        item = QTreeWidgetItem(bureautique)
        item.setText(0, "üìù Cr√©ation dossier SIG")
        item.setToolTip(0, "Mise en forme du fichier excel issue du traitement UA vers SSPF")

        # =========================
        # Cr√©ation cartographique
        # =========================
        carto = QTreeWidgetItem(tree)
        carto.setText(0, "Cr√©ation cartographique")

        data = [
            ("üå≥Create Qfield project from PARCA or UA",
             "Cr√©e un projet Qfield depuis le projet et la base de donn√©e"),
            ("üîßClassification des relev√©es",
             "Classe les relev√©es selon des param√®tres d√©finis"),
            ("üñ•Qfield vers excel et UA",
             "Mise au propre des relev√©s r√©alis√© sur le terrain vers un excel et un UA complet"),
            ("üìëClasser les ame_type",
             "Sort un excel de stat de la couche"),
            ("üéÑAjouter la r√©g√©",
             "Ajoute la r√©g√© depuis la couche terrain_point"),
            ("0Ô∏è‚É£ Retirer les 0",
             "retire les 0 de sortie sur la couche SSPF et PARFOR"),
            ("üÜóRemplacer le nom des champs",
             "Remplace le nom d'un champ"),
            ("üìèsymbologie finale",
             "ajoute les couches TSE_point, STR_point avec le style"),
        ]

        for label, tooltip in data:
            item = QTreeWidgetItem(carto)
            item.setText(0, label)
            item.setToolTip(0, tooltip)

        # =========================
        # Cartographie environnementale
        # =========================
        envi = QTreeWidgetItem(tree)
        envi.setText(0, "Cartographie environnementale")

        ua_vecteur = QTreeWidgetItem(envi)
        ua_vecteur.setText(0, "UA vers fond vecteur")

        data = [
            ("‚úíÔ∏èCreate_COM_line", "G√©n√©ration des limites de communes"),
            ("üìçCreate_TOPONY_point", "Int√©gre le nom des lieux-dits, communes et lieux d'int√©rets"),
            ("üöòCreate_ROAD_line",
             "Cr√©ation de la couche ROAD_line, avec le nom des routes et leurs classifications. source : BDTOPO IGN"),
            ("üöòCreate_HYDRO",
             "cr√©ation des couches Hydrologie contenant les plans d'eaux et rivi√®res"),
            ("üè´Create_URBAIN",
             "Ajoute les couches batis, cimeti√®res et aerodrome"),
            ("üå≤ üå≥Create_VEGE",
             "Int√©gration de la v√©g√©tation et des peuplements alentours"),
            ("üó∫Create_TOT_ENVI",
             "Permet en un appel d'√©x√©cuter l'ensemble des fonctions ci dessus"),
        ]

        for label, tooltip in data:
            item = QTreeWidgetItem(ua_vecteur)
            item.setText(0, label)
            item.setToolTip(0, tooltip)

        item = QTreeWidgetItem(envi)
        item.setText(0, "üåøUA vers BDFORET")
        item.setToolTip(0, "Ajoute la BD foret la plus r√©cente pour l'emprise de l'UA")

        # =========================
        # Traitements cartographiques
        # =========================
        traitement = QTreeWidgetItem(tree)
        traitement.setText(0, "Traitements cartographiques")

        item = QTreeWidgetItem(traitement)
        item.setText(0, "üß≥Reprojection d'un vecteur")
        item.setToolTip(0, "Reprojection d'un vecteur selon un autre CRS")

        item = QTreeWidgetItem(traitement)
        item.setText(0, "üì•Data IGN")
        item.setToolTip(0, "T√©l√©chargement des bases de donn√©es de l'IGN")

        tree.expandAll()


    def closeEvent(self, event):
        self.closingPlugin.emit()
        event.accept()
